@page
@model UniSpace.Presentation.Pages.Admin.Booking.ConfirmModel
@{
    ViewData["Title"] = "Confirm Booking Request";
}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">

<style>
    body {
        background: #000000;
        min-height: 100vh;
    }

    .glass-card {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border-radius: 20px;
        border: 1px solid rgba(255, 255, 255, 0.1);
        box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        transition: all 0.3s ease;
    }

        .glass-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 35px rgba(255, 107, 53, 0.2);
        }

    .glass-card-header {
        background: rgba(255, 107, 53, 0.15);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border-bottom: 1px solid rgba(255, 107, 53, 0.3);
        border-radius: 20px 20px 0 0;
        padding: 25px;
    }

    .glass-card-body {
        padding: 25px;
    }

    .neon-orange {
        color: #ff6b35;
    }

    .neon-orange-glow {
        color: #ff6b35;
        text-shadow: 0 0 10px rgba(255, 107, 53, 0.5);
    }

    .neon-orange-bg {
        background: rgba(255, 107, 53, 0.2);
        border: 1px solid rgba(255, 107, 53, 0.5);
    }

    .neon-orange-border {
        border-left: 4px solid #ff6b35;
    }

    .page-title {
        color: #fff;
        font-size: 2rem;
        font-weight: 700;
        margin-bottom: 0;
    }

    .page-subtitle {
        color: rgba(255, 255, 255, 0.6);
        font-size: 1rem;
    }

    .glass-btn {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 10px;
        color: #fff;
        padding: 12px 25px;
        transition: all 0.3s ease;
        font-weight: 600;
    }

        .glass-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
            color: #fff;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 255, 255, 0.1);
        }

    .glass-btn-approve {
        background: rgba(16, 185, 129, 0.2);
        border: 1px solid rgba(16, 185, 129, 0.5);
        color: #10b981;
    }

        .glass-btn-approve:hover {
            background: rgba(16, 185, 129, 0.3);
            border-color: rgba(16, 185, 129, 0.7);
            color: #10b981;
            box-shadow: 0 7px 20px rgba(16, 185, 129, 0.4);
        }

    .glass-btn-reject {
        background: rgba(239, 68, 68, 0.2);
        border: 1px solid rgba(239, 68, 68, 0.5);
        color: #ef4444;
    }

        .glass-btn-reject:hover {
            background: rgba(239, 68, 68, 0.3);
            border-color: rgba(239, 68, 68, 0.7);
            color: #ef4444;
            box-shadow: 0 7px 20px rgba(239, 68, 68, 0.4);
        }

    .info-badge {
        background: rgba(255, 107, 53, 0.2);
        border: 1px solid rgba(255, 107, 53, 0.5);
        padding: 8px 15px;
        border-radius: 20px;
        color: #ff6b35;
        font-weight: 600;
        display: inline-block;
        margin: 5px 5px 5px 0;
    }

    .time-display {
        background: rgba(255, 107, 53, 0.15);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 107, 53, 0.3);
        padding: 25px;
        border-radius: 15px;
        color: white;
        text-align: center;
        box-shadow: 0 5px 15px rgba(255, 107, 53, 0.2);
        transition: all 0.3s ease;
    }

        .time-display:hover {
            transform: scale(1.02);
            box-shadow: 0 8px 20px rgba(255, 107, 53, 0.3);
        }

    .time-display-blue {
        background: rgba(59, 130, 246, 0.15);
        border: 1px solid rgba(59, 130, 246, 0.3);
        box-shadow: 0 5px 15px rgba(59, 130, 246, 0.2);
    }

        .time-display-blue:hover {
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.3);
        }

    .section-title {
        color: #ff6b35;
        font-size: 1rem;
        font-weight: 600;
        margin-bottom: 15px;
    }

    .info-row {
        background: rgba(255, 255, 255, 0.03);
        backdrop-filter: blur(5px);
        -webkit-backdrop-filter: blur(5px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        padding: 20px;
        border-radius: 15px;
        transition: all 0.3s ease;
    }

        .info-row:hover {
            border-color: rgba(255, 107, 53, 0.4);
            background: rgba(255, 255, 255, 0.05);
            box-shadow: 0 3px 10px rgba(255, 107, 53, 0.15);
        }

    .text-white-primary {
        color: rgba(255, 255, 255, 0.9);
    }

    .text-white-secondary {
        color: rgba(255, 255, 255, 0.7);
    }

    .text-white-muted {
        color: rgba(255, 255, 255, 0.5);
    }

    .glass-divider {
        height: 2px;
        background: linear-gradient(90deg, transparent, rgba(255, 107, 53, 0.5), transparent);
        margin: 25px 0;
        border: none;
    }

    .purpose-box {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(5px);
        -webkit-backdrop-filter: blur(5px);
        border-left: 4px solid #ff6b35;
        border-radius: 10px;
        padding: 20px;
        min-height: 100px;
        font-size: 15px;
        line-height: 1.6;
        color: rgba(255, 255, 255, 0.8);
    }

    .glass-textarea {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 2px solid rgba(255, 255, 255, 0.2);
        border-radius: 10px;
        padding: 15px;
        font-size: 14px;
        color: #fff;
        transition: all 0.3s ease;
    }

        .glass-textarea::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }

        .glass-textarea:focus {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(255, 107, 53, 0.5);
            box-shadow: 0 0 15px rgba(255, 107, 53, 0.2);
            outline: none;
            color: #fff;
        }

    .glass-alert {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 15px;
        color: #fff;
        padding: 15px;
    }

        .glass-alert.alert-danger {
            border-left: 4px solid #ef4444;
            background: rgba(239, 68, 68, 0.1);
        }

        .glass-alert.alert-warning {
            border-left: 4px solid #fbbf24;
            background: rgba(251, 191, 36, 0.1);
        }

        .glass-alert.alert-info {
            border-left: 4px solid #3b82f6;
            background: rgba(59, 130, 246, 0.1);
        }

    .duration-badge {
        background: rgba(255, 107, 53, 0.2);
        border: 1px solid rgba(255, 107, 53, 0.5);
        padding: 10px 20px;
        border-radius: 25px;
        color: #ff6b35;
        font-weight: bold;
        display: inline-block;
        box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
    }

    .status-badge {
        background: rgba(251, 191, 36, 0.2);
        border: 1px solid rgba(251, 191, 36, 0.5);
        color: #fbbf24;
        padding: 8px 15px;
        border-radius: 10px;
        font-size: 1rem;
        font-weight: 600;
    }

    .pulse-badge {
        animation: pulse 2s ease-in-out infinite;
    }

    @@keyframes pulse {
        0%, 100% {
            opacity: 1;
        }

        50% {
            opacity: 0.7;
        }
    }

    .tips-card {
        background: rgba(255, 107, 53, 0.1);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 107, 53, 0.3);
        border-radius: 20px;
    }

    .tips-card-body {
        padding: 20px;
    }

    .tips-card ul li {
        color: rgba(255, 255, 255, 0.8);
    }

    .btn-close-white {
        filter: brightness(0) invert(1);
    }

    .form-label {
        color: rgba(255, 255, 255, 0.8);
        font-weight: 600;
    }

    .form-text {
        color: rgba(255, 255, 255, 0.6);
    }

    a {
        color: #ff6b35;
        text-decoration: none;
    }

        a:hover {
            color: #ff8c5f;
        }

    .decision-header {
        background: rgba(251, 191, 36, 0.15);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border-bottom: 2px solid rgba(251, 191, 36, 0.5);
        border-radius: 20px 20px 0 0;
        padding: 20px;
    }
</style>

<div class="container-fluid mt-4 px-4">
    <!-- Header -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center flex-wrap gap-3">
                <div>
                    <h1 class="page-title mb-2">
                        <i class="bi bi-clipboard-check neon-orange-glow"></i>
                        Confirm Booking Request
                    </h1>
                    <p class="page-subtitle mb-0">Review and make a decision on this booking request</p>
                </div>
                <a asp-page="./Index" class="btn glass-btn">
                    <i class="bi bi-arrow-left"></i> Back to List
                </a>
            </div>
        </div>
    </div>

    @if (!string.IsNullOrEmpty(Model.ErrorMessage))
    {
        <div class="glass-alert alert-danger alert-dismissible fade show mb-4" role="alert">
            <i class="bi bi-exclamation-triangle-fill me-2"></i>
            <strong>Error!</strong> @Model.ErrorMessage
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="alert"></button>
        </div>
    }

    @if (Model.Booking == null)
    {
        <div class="glass-alert alert-warning" role="alert">
            <h4 class="text-white-primary mb-3">
                <i class="bi bi-exclamation-triangle neon-orange"></i> Booking Not Available
            </h4>
            <p class="text-white-secondary">The booking information could not be loaded. This may be because:</p>
            <ul class="text-white-secondary mb-3">
                <li>The booking ID is invalid</li>
                <li>The booking has been deleted</li>
                <li>You don't have permission to view this booking</li>
            </ul>
            <div class="glass-divider"></div>
            <p class="mb-0">
                <a asp-page="./Index" class="btn glass-btn">
                    <i class="bi bi-arrow-left"></i> Back to Booking List
                </a>
            </p>
        </div>
    }
    else
    {
        <div class="row g-4">
            <!-- Left Column - Booking Details -->
            <div class="col-lg-7">
                <!-- Main Booking Info Card -->
                <div class="glass-card mb-4">
                    <div class="glass-card-header">
                        <h4 class="mb-0 text-white-primary">
                            <i class="bi bi-bookmark-star neon-orange"></i> Booking Information
                        </h4>
                    </div>
                    <div class="glass-card-body">
                        <!-- User & Room Information -->
                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <div class="info-row">
                                    <h6 class="section-title mb-3">
                                        <i class="bi bi-person-circle"></i> User Information
                                    </h6>
                                    <div class="mb-2">
                                        <small class="text-white-muted d-block mb-1">Full Name</small>
                                        <strong class="fs-5 text-white-primary">@Model.Booking.UserName</strong>
                                    </div>
                                    <div>
                                        <small class="text-white-muted d-block mb-1">Email Address</small>
                                        <a href="mailto:@Model.Booking.UserEmail">
                                            <i class="bi bi-envelope"></i> @Model.Booking.UserEmail
                                        </a>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="info-row">
                                    <h6 class="section-title mb-3">
                                        <i class="bi bi-door-open"></i> Room Information
                                    </h6>
                                    <div class="mb-2">
                                        <small class="text-white-muted d-block mb-1">Room Name</small>
                                        <strong class="fs-5 text-white-primary">@Model.Booking.RoomName</strong>
                                    </div>
                                    <div class="mt-2">
                                        <span class="info-badge">
                                            <i class="bi bi-building"></i> @Model.Booking.CampusName
                                        </span>
                                        <span class="info-badge">
                                            <i class="bi bi-tag"></i> @Model.Booking.RoomTypeDisplay
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="glass-divider"></div>

                        <!-- Schedule Information -->
                        <div class="mb-4">
                            <h6 class="section-title mb-3">
                                <i class="bi bi-calendar-range"></i> Schedule Details
                            </h6>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <div class="time-display">
                                        <div class="mb-2">
                                            <i class="bi bi-calendar-event fs-3 neon-orange"></i>
                                        </div>
                                        <small class="d-block text-white-muted mb-2">Start Time</small>
                                        <h4 class="text-white-primary mb-1">@Model.Booking.StartTime.ToString("HH:mm")</h4>
                                        <small class="d-block text-white-secondary">@Model.Booking.StartTime.ToString("dddd, dd MMMM yyyy")</small>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="time-display time-display-blue">
                                        <div class="mb-2">
                                            <i class="bi bi-calendar-check fs-3" style="color: #3b82f6;"></i>
                                        </div>
                                        <small class="d-block text-white-muted mb-2">End Time</small>
                                        <h4 class="text-white-primary mb-1">@Model.Booking.EndTime.ToString("HH:mm")</h4>
                                        <small class="d-block text-white-secondary">@Model.Booking.EndTime.ToString("dddd, dd MMMM yyyy")</small>
                                    </div>
                                </div>
                            </div>
                            <div class="text-center mt-3">
                                @{
                                    var duration = Model.Booking.EndTime - Model.Booking.StartTime;
                                    <span class="duration-badge">
                                        <i class="bi bi-clock-history"></i>
                                        Duration: @duration.TotalHours.ToString("0.##") hours
                                    </span>
                                }
                            </div>
                        </div>

                        <div class="glass-divider"></div>

                        <!-- Purpose -->
                        <div class="mb-4">
                            <h6 class="section-title mb-3">
                                <i class="bi bi-chat-left-quote"></i> Purpose of Booking
                            </h6>
                            <div class="purpose-box">
                                <i class="bi bi-quote fs-4 text-white-muted d-block mb-2"></i>
                                <p class="mb-0">@Model.Booking.Purpose</p>
                            </div>
                        </div>

                        <!-- Status & Metadata -->
                        <div class="row g-3">
                            <div class="col-md-6">
                                <div class="info-row">
                                    <small class="text-white-muted d-block mb-2">Current Status</small>
                                    <span class="status-badge pulse-badge">
                                        <i class="bi bi-clock"></i> @Model.Booking.StatusDisplay
                                    </span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="info-row">
                                    <small class="text-white-muted d-block mb-2">Requested On</small>
                                    <strong class="text-white-primary">
                                        <i class="bi bi-calendar2 neon-orange"></i>
                                        @Model.Booking.CreatedAt.ToString("MMM dd, yyyy 'at' HH:mm")
                                    </strong>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column - Decision Form -->
            <div class="col-lg-5">
                <!-- Decision Card -->
                <div class="glass-card mb-4">
                    <div class="decision-header text-center">
                        <h4 class="mb-1 text-white-primary">
                            <i class="bi bi-clipboard-check" style="color: #fbbf24;"></i> Admin Decision
                        </h4>
                        <small class="d-block mt-1 text-white-secondary">Make your decision carefully</small>
                    </div>
                    <div class="glass-card-body">
                        <form method="post" id="confirmForm">
                            <input type="hidden" asp-for="Input.Id" />

                            <!-- Admin Note -->
                            <div class="mb-4">
                                <label class="form-label mb-3">
                                    <i class="bi bi-pen neon-orange"></i> Admin Note
                                </label>
                                <textarea asp-for="Input.AdminNote"
                                          class="form-control glass-textarea"
                                          rows="6"
                                          id="adminNote"
                                          maxlength="500"
                                          placeholder="Enter your note here...
    • Why are you approving/rejecting?
    • Any special instructions for the user?
    • Additional comments or recommendations"></textarea>
                                <div class="form-text mt-2">
                                    <i class="bi bi-info-circle"></i>
                                    <span id="noteRequirement">
                                        Optional for approval, <strong class="neon-orange">required for rejection</strong>
                                    </span>
                                </div>
                                <div class="mt-2">
                                    <small class="text-white-muted">
                                        Characters: <span id="charCount">0</span> / 500
                                    </small>
                                </div>
                            </div>

                            <!-- Important Notice -->
                            <div class="glass-alert alert-info mb-4">
                                <h6 class="text-white-primary mb-2">
                                    <i class="bi bi-exclamation-circle neon-orange"></i> Important Notice
                                </h6>
                                <ul class="mb-0 small text-white-secondary" style="line-height: 1.8;">
                                    <li><strong class="text-white-primary">Approve:</strong> User can use the room</li>
                                    <li><strong class="text-white-primary">Reject:</strong> User notified with your reason</li>
                                    <li>Action <strong class="text-white-primary">cannot be undone</strong></li>
                                    <li><i class="bi bi-envelope neon-orange"></i> User receives email notification</li>
                                </ul>
                            </div>

                            <!-- Action Buttons -->
                            <div class="d-grid gap-3">
                                <button type="submit"
                                        asp-page-handler="Approve"
                                        class="btn glass-btn-approve"
                                        id="approveBtn">
                                    <i class="bi bi-check-circle-fill me-2"></i>
                                    <strong>Approve Booking</strong>
                                </button>

                                <button type="submit"
                                        asp-page-handler="Reject"
                                        class="btn glass-btn-reject"
                                        id="rejectBtn">
                                    <i class="bi bi-x-circle-fill me-2"></i>
                                    <strong>Reject Booking</strong>
                                </button>

                                <a asp-page="./Index" class="btn glass-btn">
                                    <i class="bi bi-arrow-left me-2"></i>Cancel
                                </a>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Tips Card -->
                <div class="tips-card">
                    <div class="tips-card-body">
                        <h6 class="mb-3 text-white-primary">
                            <i class="bi bi-lightbulb-fill me-2 neon-orange"></i>Review Checklist
                        </h6>
                        <ul class="mb-0 small" style="line-height: 2;">
                            <li class="text-white-secondary"><i class="bi bi-check2 me-2 neon-orange"></i>Purpose is appropriate and clear</li>
                            <li class="text-white-secondary"><i class="bi bi-check2 me-2 neon-orange"></i>No schedule conflicts</li>
                            <li class="text-white-secondary"><i class="bi bi-check2 me-2 neon-orange"></i>Room type matches the purpose</li>
                            <li class="text-white-secondary"><i class="bi bi-check2 me-2 neon-orange"></i>Duration is reasonable</li>
                            <li class="text-white-secondary"><i class="bi bi-check2 me-2 neon-orange"></i>User has good booking history</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    }
</div>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        $(document).ready(function() {
            @if (Model.Booking != null)
            {
                        @:var adminNote = $('#adminNote');
                        @:var charCount = $('#charCount');
                        @:var approveBtn = $('#approveBtn');
                        @:var rejectBtn = $('#rejectBtn');
                        @:var noteRequirement = $('#noteRequirement');
                        @:
                        @:// Character counter
                        @:adminNote.on('input', function() {
                            @:var length = $(this).val().length;
                            @:charCount.text(length);
                            @:
                            @:if (length > 500) {
                                @:charCount.addClass('text-danger fw-bold');
                                @:$(this).css('border-color', '#ef4444');
                            @:} else if (length > 450) {
                                @:charCount.addClass('fw-bold');
                                @:charCount.css('color', '#fbbf24');
                                @:charCount.removeClass('text-danger');
                                @:$(this).css('border-color', 'rgba(255, 255, 255, 0.2)');
                            @:} else {
                                @:charCount.removeClass('text-danger fw-bold');
                                @:charCount.css('color', 'rgba(255, 255, 255, 0.5)');
                                @:$(this).css('border-color', 'rgba(255, 255, 255, 0.2)');
                            @:}
                        @:});
                        @:
                        @:// Approve button confirmation
                        @:approveBtn.on('click', function(e) {
                            @:e.preventDefault();
                            @:console.log('[Approve] Button clicked - BookingId:', '@Model.Booking.Id');
                            @:
                            @:var form = $(this).closest('form');
                            @:console.log('[Approve] Form action:', form.attr('action'));
                            @:console.log('[Approve] Form method:', form.attr('method'));
                            @:
                            @:Swal.fire({
                                @:title: 'Approve Booking?',
                                @:html: '<div class="text-start"><p class="mb-2"><strong>User:</strong> @Model.Booking.UserName</p><p class="mb-2"><strong>Room:</strong> @Model.Booking.RoomName</p><p class="mb-3"><strong>Date:</strong> @Model.Booking.StartTime.ToString("MMM dd, yyyy")</p><p class="text-muted mb-0"><i class="bi bi-info-circle"></i> The user will be notified and can use the room.</p></div>',
                                @:icon: 'question',
                                @:showCancelButton: true,
                                @:confirmButtonColor: '#10b981',
                                @:cancelButtonColor: '#6c757d',
                                @:confirmButtonText: '<i class="bi bi-check-circle"></i> Yes, Approve!',
                                @:cancelButtonText: 'Cancel',
                                @:background: '#1a1a1a',
                                @:color: '#fff'
                            @:}).then((result) => {
                                @:if (result.isConfirmed) {
                                    @:console.log('[Approve] User confirmed - Submitting form with handler: Approve');
                                    @:// Đảm bảo submit với đúng handler
                                    @:form.attr('action', '?handler=Approve');
                                    @:console.log('[Approve] Form action updated:', form.attr('action'));
                                    @:form.submit();
                                @:} else {
                                    @:console.log('[Approve] User cancelled');
                                @:}
                            @:});
                        @:});
                        @:
                        @:// Reject button confirmation
                        @:rejectBtn.on('click', function(e) {
                            @:e.preventDefault();
                            @:console.log('[Reject] Button clicked - BookingId:', '@Model.Booking.Id');
                            @:
                            @:var note = adminNote.val().trim();
                            @:console.log('[Reject] Admin note length:', note.length);
                            @:
                            @:if (!note || note.length < 10) {
                                @:console.log('[Reject] ERROR: Admin note too short or empty');
                                @:Swal.fire({
                                    @:title: 'Admin Note Required!',
                                    @:html: '<p class="mb-0">You must provide a meaningful reason (at least 10 characters) for rejecting this booking.</p>',
                                    @:icon: 'warning',
                                    @:confirmButtonColor: '#ef4444',
                                    @:confirmButtonText: 'OK',
                                    @:background: '#1a1a1a',
                                    @:color: '#fff'
                                @:});
                                @:adminNote.css('border-color', '#ef4444').focus();
                                @:noteRequirement.css('color', '#ef4444');
                                @:return;
                            @:}
                            @:
                            @:var form = $(this).closest('form');
                            @:console.log('[Reject] Form action:', form.attr('action'));
                            @:console.log('[Reject] Form method:', form.attr('method'));
                            @:
                            @:Swal.fire({
                                @:title: 'Reject Booking?',
                                @:html: '<div class="text-start"><p class="mb-2"><strong>User:</strong> @Model.Booking.UserName</p><p class="mb-2"><strong>Room:</strong> @Model.Booking.RoomName</p><div class="alert alert-warning mt-3 mb-3"><strong><i class="bi bi-chat-left-text"></i> Your note:</strong><br><span class="small">' + note + '</span></div><p class="text-danger mb-0"><i class="bi bi-exclamation-triangle"></i> This action cannot be undone!</p></div>',
                                @:icon: 'warning',
                                @:showCancelButton: true,
                                @:confirmButtonColor: '#ef4444',
                                @:cancelButtonColor: '#6c757d',
                                @:confirmButtonText: '<i class="bi bi-x-circle"></i> Yes, Reject!',
                                @:cancelButtonText: 'Cancel',
                                @:background: '#1a1a1a',
                                @:color: '#fff'
                            @:}).then((result) => {
                                @:if (result.isConfirmed) {
                                    @:console.log('[Reject] User confirmed - Submitting form with handler: Reject');
                                    @:// Đảm bảo submit với đúng handler
                                    @:form.attr('action', '?handler=Reject');
                                    @:console.log('[Reject] Form action updated:', form.attr('action'));
                                    @:form.submit();
                                @:} else {
                                    @:console.log('[Reject] User cancelled');
                                @:}
                            @:});
                        @:});
                        @:
                        @:// Auto-dismiss alerts
                        @:setTimeout(function() {
                            @:$('.glass-alert').fadeOut('slow');
                        @:}, 5000);
                        @:
                        @:// Highlight note field when reject is hovered
                        @:rejectBtn.on('mouseenter', function() {
                            @:var note = adminNote.val().trim();
                            @:if (!note || note.length < 10) {
                                @:adminNote.css('border-color', '#fbbf24');
                                @:noteRequirement.css('color', '#fbbf24');
                            @:}
                        @:});
                        @:
                        @:rejectBtn.on('mouseleave', function() {
                            @:adminNote.css('border-color', 'rgba(255, 255, 255, 0.2)');
                            @:noteRequirement.css('color', 'rgba(255, 255, 255, 0.6)');
                        @:});
            }
        });
    </script>
}